<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

    <title>Dinner Date Survey</title>  

</head>

<body>
    <div class="container">

        <div class="jumbotron">
            <h1 class="text-center"><span class="glyphicon glyphicon-ice-lolly-tasted"></span> Dinner Date</h1>
            <hr>
            <h2 class="text-center">Find Your Perfect Food Match!</h2>
            <br>

            <div class="text-center">

                <a href="/"><button type="button" class="btn btn-lg btn-default"><span class="glyphicon glyphicon-home"></span></button></a>

            </div>
        </div>


        <div class="col-lg-12">

            <div class="panel panel-default">

                <!-- <div class="panel-heading">
                    <h4 class="panel-title">Survey</h4>
                </div> -->

                <div class="panel-body">

                    <form id="survey-form" role="form">       

                        <div>
                            <h2>Profile Info:</h2>
                        </div>

                        <div>
                            <h4>Please enter your name:</h4>  
                            <input type="text" name="name">          
                        </div>

                        <div>
                            <h4>Please enter the URL of a personal photo:</h4>  
                            <input type="text" name="photo">          
                        </div>
                        
                        <br>
                        <hr>

                        <div>
                            <h2>Survey:</h2>
                        </div>

                        <div>
                            <h4>Please rate each of the following foods from 1 (worst) to 5 (best):</h4>
                        </div>

                        <div>
                            <h3>Donuts</h3>
                            <label class="radio-inline"><input class="required" type="radio" name="question1" value="1">1</label>
                            <label class="radio-inline"><input type="radio" name="question1" value="2">2</label>
                            <label class="radio-inline"><input type="radio" name="question1" value="3">3</label>
                            <label class="radio-inline"><input type="radio" name="question1" value="4">4</label>
                            <label class="radio-inline"><input type="radio" name="question1" value="5">5</label>
                        </div>
                        <div>
                            <h3>BBQ</h3>
                            <label class="radio-inline"><input type="radio" name="question2" value="1">1</label>
                            <label class="radio-inline"><input type="radio" name="question2" value="2">2</label>
                            <label class="radio-inline"><input type="radio" name="question2" value="3">3</label>
                            <label class="radio-inline"><input type="radio" name="question2" value="4">4</label>
                            <label class="radio-inline"><input type="radio" name="question2" value="5">5</label>
                        </div>
                        <div>                            
                            <h3>Sushi</h3>
                            <label class="radio-inline"><input type="radio" name="question3" value="1">1</label>
                            <label class="radio-inline"><input type="radio" name="question3" value="2">2</label>
                            <label class="radio-inline"><input type="radio" name="question3" value="3">3</label>
                            <label class="radio-inline"><input type="radio" name="question3" value="4">4</label>
                            <label class="radio-inline"><input type="radio" name="question3" value="5">5</label>
                        </div>
                        <div>
                            <h3>Cake</h3>
                            <label class="radio-inline"><input type="radio" name="question4" value="1">1</label>
                            <label class="radio-inline"><input type="radio" name="question4" value="2">2</label>
                            <label class="radio-inline"><input type="radio" name="question4" value="3">3</label>
                            <label class="radio-inline"><input type="radio" name="question4" value="4">4</label>
                            <label class="radio-inline"><input type="radio" name="question4" value="5">5</label>
                        </div>
                        <div>
                            <h3>Pasta</h3>
                            <label class="radio-inline"><input type="radio" name="question5" value="1">1</label>
                            <label class="radio-inline"><input type="radio" name="question5" value="2">2</label>
                            <label class="radio-inline"><input type="radio" name="question5" value="3">3</label>
                            <label class="radio-inline"><input type="radio" name="question5" value="4">4</label>
                            <label class="radio-inline"><input type="radio" name="question5" value="5">5</label>
                        </div>
                        <div>
                            <h3>Bacon</h3>
                            <label class="radio-inline"><input type="radio" name="question6" value="1">1</label>
                            <label class="radio-inline"><input type="radio" name="question6" value="2">2</label>
                            <label class="radio-inline"><input type="radio" name="question6" value="3">3</label>
                            <label class="radio-inline"><input type="radio" name="question6" value="4">4</label>
                            <label class="radio-inline"><input type="radio" name="question6" value="5">5</label>
                        </div>
                        <div>
                            <h3>Curry</h3>
                            <label class="radio-inline"><input type="radio" name="question7" value="1">1</label>
                            <label class="radio-inline"><input type="radio" name="question7" value="2">2</label>
                            <label class="radio-inline"><input type="radio" name="question7" value="3">3</label>
                            <label class="radio-inline"><input type="radio" name="question7" value="4">4</label>
                            <label class="radio-inline"><input type="radio" name="question7" value="5">5</label>
                        </div>
                        <div>                            
                            <h3>Tacos</h3>
                            <label class="radio-inline"><input type="radio" name="question8" value="1">1</label>
                            <label class="radio-inline"><input type="radio" name="question8" value="2">2</label>
                            <label class="radio-inline"><input type="radio" name="question8" value="3">3</label>
                            <label class="radio-inline"><input type="radio" name="question8" value="4">4</label>
                            <label class="radio-inline"><input type="radio" name="question8" value="5">5</label>
                        </div>
                        <div>
                            <h3>Salad</h3>
                            <label class="radio-inline"><input type="radio" name="question9" value="1">1</label>
                            <label class="radio-inline"><input type="radio" name="question9" value="2">2</label>
                            <label class="radio-inline"><input type="radio" name="question9" value="3">3</label>
                            <label class="radio-inline"><input type="radio" name="question9" value="4">4</label>
                            <label class="radio-inline"><input type="radio" name="question9" value="5">5</label>
                        </div>
                        <div>
                            <h3>Bread</h3>
                            <label class="radio-inline"><input type="radio" name="question10" value="1">1</label>
                            <label class="radio-inline"><input type="radio" name="question10" value="2">2</label>
                            <label class="radio-inline"><input type="radio" name="question10" value="3">3</label>
                            <label class="radio-inline"><input type="radio" name="question10" value="4">4</label>
                            <label class="radio-inline"><input type="radio" name="question10" value="5">5</label>
                        </div>  
                        <br>

                        <button type="button" class="btn btn-primary submit btn-lg" >Find Your Match!</button>

                    </form>

                </div>

            </div>

        </div>

    </div>

    <!-- Results Modal -->
    <div id="myModal" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Your Best Dinner Match is:</h4>
                </div>
                <div class="modal-body">
                    <img id= "match-image" src="http://lorempixel.com/output/abstract-q-c-200-200-5.jpg" alt="Your Match!">
                    <h2 id="best-match-name">Error!</h2>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>

        </div>
    </div>

    <!-- Error Modal -->
    <div id="errorModal" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Error!</h4>
                </div>
                <div class="modal-body">
                    <h2 id="best-match-name">Please provide an answer for each question.</h2>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>

        </div>
    </div>

    <script type="text/javascript">

        // checks that each form element has value
        function validateForm(data){
            var isValid = true;
            console.log(data)

            for( var i = 0; i < 11; i++ ){
                
                if( data[i] === undefined ){
                    isValid = false;
                }
                else if( data[i].value === '' || data[i].value === undefined ){
                    isValid = false;
                };

            };
            return isValid;
        };

        //when submit clicked
        $(".submit").on("click", function(event) {
            //prevent form / reload
            event.preventDefault();
            
            //capture the form data in newFriend            
            var newFriend = $('#survey-form').serializeArray();
            // console.log(newFriend);

            //INPUT VALIDATION NEEDED -- check for name, image, and survey values

            if (validateForm(newFriend)){

                //post newFriend data to server
                $.post("/api/new", newFriend)
                .done(function(data) {

                    //change image and match name in modal to data returned by server
                    $('#match-image').attr('src', data.photo);
                    $('#best-match-name').text(data.name);

                    $("#myModal").modal('toggle');

                });
            }

            else{
                $("#errorModal").modal('toggle');
            }

        });

    </script>

</body>

</html>